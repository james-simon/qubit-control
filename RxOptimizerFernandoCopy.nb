(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32612,        697]
NotebookOptionsPosition[     32149,        676]
NotebookOutlinePosition[     32522,        692]
CellTagsIndexPosition[     32479,        689]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Auxiliary functions", "Section",
 CellChangeTimes->{{3.753034379067154*^9, 3.753034383520705*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fidelityXY", "[", "M_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Utarget", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", "\[Sigma]X"}], " ", "+", 
       " ", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", "\[Sigma]Y"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NMaximize", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"fidelity2D", "[", 
          RowBox[{"Utarget", ",", " ", "M"}], "]"}], "]"}], ",", " ", 
        RowBox[{"{", "\[Theta]", "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XYangle", "[", "M_", "]"}], " ", ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Utarget", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", "\[Sigma]X"}], " ", "+", 
       " ", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", "\[Sigma]Y"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", " ", "/.", " ", 
      RowBox[{
       RowBox[{"NMaximize", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"fidelity2D", "[", 
           RowBox[{"Utarget", ",", " ", "M"}], "]"}], "]"}], ",", " ", 
         RowBox[{"{", "\[Theta]", "}"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "fidelityToGate", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fidelityToGate", "[", 
    RowBox[{
     RowBox[{"Ea_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"Ba_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"\[Omega]Ein_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"\[Omega]Bin_", "?", "NumericQ"}], ",", "gate_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"Eamp", ",", " ", "Bamp"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Eamp", "[", "t_", "]"}], " ", ":=", " ", 
      RowBox[{"Ea", "*", 
       SuperscriptBox[
        RowBox[{"cosWindow", "[", 
         RowBox[{
          RowBox[{"t", " ", "-", " ", "T1"}], ",", " ", 
          RowBox[{"T2", "/", "5"}], ",", " ", "T2"}], "]"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bamp", "[", "t_", "]"}], " ", ":=", " ", 
      RowBox[{"Ba", "*", 
       SuperscriptBox[
        RowBox[{"cosWindow", "[", 
         RowBox[{
          RowBox[{"t", " ", "-", " ", "T1"}], ",", " ", 
          RowBox[{"T2", "/", "5"}], ",", " ", "T2"}], "]"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]E", " ", "=", " ", "\[Omega]Ein"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]B", " ", "=", " ", "\[Omega]Bin"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"U", " ", "=", " ", 
      RowBox[{"findEvolutionOperator2D", "[", 
       RowBox[{"Hexact", ",", " ", "Tmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gate", " ", "\[Equal]", " ", "\"\<XY\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"F", " ", "=", " ", 
         RowBox[{"fidelityXY", "[", 
          RowBox[{"U", " ", "/.", " ", 
           RowBox[{"t", "\[Rule]", "Tmax"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"F", " ", "=", " ", 
         RowBox[{
          RowBox[{"fidelity2D", "[", 
           RowBox[{"gate", ",", " ", 
            RowBox[{"U", " ", "/.", " ", 
             RowBox[{"t", "\[Rule]", "Tmax"}]}]}], "]"}], " ", "//", " ", 
          "Chop"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"F", ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "\[CapitalDelta]E", ",", " ", "B0", ",", "Vt", ",", " ", "Ea", ",", 
           " ", "Ba", ",", " ", "\[Omega]Ein", ",", " ", "\[Omega]Bin", ",", 
           " ", "Tmax"}], "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"output", " ", "=", " ", "F"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"output", " ", ">", " ", "bestSoFar"}], ",", " ", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bestSoFar", " ", "=", " ", "output"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bestParameters", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
           "\[CapitalDelta]E", ",", " ", "B0", ",", "Vt", ",", " ", "Ea", ",",
             " ", "Ba", ",", " ", "\[Omega]Ein", ",", " ", "\[Omega]Bin", ",",
             " ", "Tmax"}], "}"}]}], ";"}], "\[IndentingNewLine]", ")"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Pause", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "output"}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "map", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"map", "[", 
    RowBox[{"x_", ",", " ", "a_", ",", " ", "b_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"a", " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"b", " ", "-", " ", "a"}], ")"}], "*", "x"}]}], " ", "//", " ",
     "Re"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.748868042823764*^9, 3.7488681045182185`*^9}, {
   3.7488681749646297`*^9, 3.7488682445255513`*^9}, {3.748868301590673*^9, 
   3.7488685646671*^9}, {3.7488686147372503`*^9, 3.748868696235155*^9}, {
   3.7488688286698513`*^9, 3.748868837837569*^9}, {3.7488690219125137`*^9, 
   3.7488690912574162`*^9}, {3.7488691222425632`*^9, 3.748869137421818*^9}, {
   3.7488691771948414`*^9, 3.7488692534118557`*^9}, {3.748869491181861*^9, 
   3.7488695902772646`*^9}, {3.7488696203817296`*^9, 3.74886962749563*^9}, {
   3.748869733418502*^9, 3.7488697342070475`*^9}, {3.7488698987375774`*^9, 
   3.7488699036307592`*^9}, {3.7488699497951603`*^9, 3.748869981837699*^9}, {
   3.748870032903277*^9, 3.748870183071757*^9}, {3.7488703060429063`*^9, 
   3.7488704085688334`*^9}, {3.7488704500449376`*^9, 
   3.7488705400294557`*^9}, {3.748870584788613*^9, 3.7488706450780506`*^9}, {
   3.7488707240459476`*^9, 3.74887072912702*^9}, 3.7488709149040666`*^9, {
   3.7488711523767514`*^9, 3.748871153813923*^9}, {3.7488714954546614`*^9, 
   3.7488715099193287`*^9}, {3.748871868761881*^9, 3.748871942174532*^9}, {
   3.748872020382021*^9, 3.7488720226896915`*^9}, {3.748872069173199*^9, 
   3.7488722190637712`*^9}, {3.7488722803104596`*^9, 
   3.7488723320313826`*^9}, {3.7488725330016737`*^9, 3.748872619638477*^9}, {
   3.748876640016803*^9, 3.748876666094777*^9}, {3.748877051704959*^9, 
   3.74887715371215*^9}, {3.7488773504125185`*^9, 3.7488773794297876`*^9}, {
   3.748877856107978*^9, 3.74887796041984*^9}, {3.748878001674057*^9, 
   3.748878055889801*^9}, {3.748878088478014*^9, 3.7488781137684326`*^9}, {
   3.7488807866597347`*^9, 3.74888091302888*^9}, {3.7488811187512217`*^9, 
   3.748881124855708*^9}, {3.748882474186612*^9, 3.7488825046242766`*^9}, {
   3.7488830297579947`*^9, 3.748883060950012*^9}, {3.7488834448517227`*^9, 
   3.748883445423387*^9}, {3.748883595607071*^9, 3.7488836543901005`*^9}, {
   3.748883703205963*^9, 3.748883719920326*^9}, {3.748883755293934*^9, 
   3.7488837627846127`*^9}, {3.748884464075526*^9, 3.748884469485408*^9}, {
   3.748884594545309*^9, 3.7488846219585266`*^9}, {3.748884666165019*^9, 
   3.7488846762831864`*^9}, 3.7488847559020643`*^9, {3.7488850776327524`*^9, 
   3.748885115718807*^9}, {3.748885295904167*^9, 3.748885297224434*^9}, {
   3.7488970465029016`*^9, 3.748897082243295*^9}, {3.748897565079009*^9, 
   3.7488975701660767`*^9}, {3.7488977325734463`*^9, 3.748897737291775*^9}, {
   3.7488983530857162`*^9, 3.7488983534495*^9}, {3.749299172533746*^9, 
   3.7492991801593485`*^9}, {3.7493000291645174`*^9, 
   3.7493000312942915`*^9}, {3.7493020534701023`*^9, 3.749302056799182*^9}, {
   3.749302539692789*^9, 3.7493025442311735`*^9}, {3.7493030218320704`*^9, 
   3.74930304316677*^9}, {3.7493036615308275`*^9, 3.749303682676637*^9}, 
   3.7493045937365503`*^9, {3.749305297652417*^9, 3.7493053053120003`*^9}, {
   3.749770451046073*^9, 3.749770481650054*^9}, {3.7497705237406445`*^9, 
   3.7497705560097656`*^9}, {3.7497712105002127`*^9, 
   3.7497712720906844`*^9}, {3.7497713324324102`*^9, 3.749771459847307*^9}, {
   3.749771765194148*^9, 3.749771806057583*^9}, {3.7497721116463747`*^9, 
   3.7497721287605023`*^9}, 3.7497721767080355`*^9, {3.7497724013475375`*^9, 
   3.7497724016073885`*^9}, {3.7497727680317106`*^9, 
   3.7497727718914833`*^9}, {3.7497826469480915`*^9, 3.749782650369113*^9}, {
   3.749782719436269*^9, 3.7497827306588044`*^9}, {3.7497831485477285`*^9, 
   3.749783160115057*^9}, {3.749783768988895*^9, 3.7497837846498375`*^9}, {
   3.749783822590952*^9, 3.7497838507796907`*^9}, {3.750687181309536*^9, 
   3.750687230994295*^9}, {3.750692002223221*^9, 3.750692033173361*^9}, {
   3.750725607432372*^9, 3.75072564377551*^9}, {3.7507260143209114`*^9, 
   3.750726018748369*^9}, {3.7507333632398744`*^9, 3.750733416569871*^9}, {
   3.750733468013812*^9, 3.7507335648851376`*^9}, {3.750767218297253*^9, 
   3.7507672200979004`*^9}, {3.7507678537739935`*^9, 
   3.7507678617330866`*^9}, {3.7507678983593874`*^9, 
   3.7507679925629425`*^9}, {3.7507680372225056`*^9, 
   3.7507680534283895`*^9}, {3.7507685797788267`*^9, 3.7507686069737177`*^9}, 
   3.750772246677681*^9, {3.750775574691947*^9, 3.750775639812272*^9}, {
   3.7507805858844547`*^9, 3.750780607699105*^9}, {3.7507806382722263`*^9, 
   3.750780783429366*^9}, {3.750781582272604*^9, 3.7507815829553337`*^9}, {
   3.750783610280716*^9, 3.750783636885186*^9}, {3.750982968917549*^9, 
   3.7509829947428656`*^9}, {3.750983108460089*^9, 3.7509831245063267`*^9}, {
   3.7509945453079543`*^9, 3.7509946035057135`*^9}, {3.7509946929383593`*^9, 
   3.750994729126266*^9}, {3.7509948936083674`*^9, 3.750995168356369*^9}, {
   3.750995284808712*^9, 3.750995292908842*^9}, {3.750995337106987*^9, 
   3.7509953781793613`*^9}, {3.75099542952024*^9, 3.750995430658269*^9}, {
   3.7509955958695173`*^9, 3.7509956974159603`*^9}, {3.750996040324638*^9, 
   3.7509960477044344`*^9}, {3.7510856463996506`*^9, 
   3.7510856853002496`*^9}, {3.751292570630089*^9, 3.751292579065151*^9}, {
   3.7512926121426315`*^9, 3.751292730456869*^9}, {3.7512927968095856`*^9, 
   3.7512927980884123`*^9}, {3.751292845025528*^9, 3.751292865994632*^9}, {
   3.7512929198532343`*^9, 3.7512929246179304`*^9}, {3.7512929760167274`*^9, 
   3.751293011617013*^9}, {3.7512930454628286`*^9, 3.7512930604965954`*^9}, {
   3.7512933633627343`*^9, 3.751293392247506*^9}, {3.751293494028467*^9, 
   3.751293496774276*^9}, {3.75129384558178*^9, 3.751293855127629*^9}, {
   3.751293973004285*^9, 3.7512940427519665`*^9}, {3.751294074978858*^9, 
   3.7512940854372296`*^9}, {3.7512956349051423`*^9, 3.751295635157172*^9}, {
   3.751299209378405*^9, 3.7512992106235495`*^9}, {3.7518097921335583`*^9, 
   3.7518097928731327`*^9}, {3.751809827906107*^9, 3.751810030181779*^9}, {
   3.751812594259968*^9, 3.7518125989672604`*^9}, {3.751812693651807*^9, 
   3.751812721004077*^9}, {3.7518127780052967`*^9, 3.7518128116041813`*^9}, {
   3.751813371735674*^9, 3.751813387888392*^9}, {3.751929275022686*^9, 
   3.75192938843734*^9}, 3.7519297037486706`*^9, {3.751929858335792*^9, 
   3.7519299004595194`*^9}, {3.751929948078083*^9, 3.751930091406503*^9}, 
   3.751930162140749*^9, {3.7519302374193764`*^9, 3.7519302459684525`*^9}, {
   3.7519306184688315`*^9, 3.751930637754144*^9}, {3.7530306449920783`*^9, 
   3.7530306475715985`*^9}, {3.7530343192444324`*^9, 3.753034352681568*^9}, {
   3.7530344644102917`*^9, 3.753034512818576*^9}, {3.7530345799110394`*^9, 
   3.753034674456778*^9}, {3.7530384722187634`*^9, 3.7530385251163483`*^9}, {
   3.753384737785122*^9, 3.753384738331643*^9}, {3.753385108684747*^9, 
   3.7533851150484333`*^9}, {3.7533867264848485`*^9, 
   3.7533868298171277`*^9}, {3.7533922279582195`*^9, 3.753392243692233*^9}, 
   3.753392656458619*^9, {3.7534387256212783`*^9, 3.753438730116698*^9}, {
   3.753461969821021*^9, 3.7534620194489336`*^9}, {3.753489626868245*^9, 
   3.753489631455593*^9}, {3.7534907660374975`*^9, 3.7534907672637877`*^9}, {
   3.7534928654327064`*^9, 3.753492866446122*^9}, {3.7535467919991307`*^9, 
   3.753546823715802*^9}, {3.7541352154257226`*^9, 3.754135237957716*^9}, {
   3.7541353641309347`*^9, 3.7541353658109655`*^9}, 3.7541354172503104`*^9, {
   3.7541354500044155`*^9, 3.7541354813393407`*^9}, {3.754135535517086*^9, 
   3.754135555945301*^9}, 3.7541356741351223`*^9, 3.7541369320852222`*^9, {
   3.754145435227892*^9, 3.7541454493297586`*^9}, {3.7541666931770005`*^9, 
   3.75416669425638*^9}, {3.767295470987585*^9, 3.7672954734431643`*^9}, 
   3.7673288664160776`*^9, {3.767466286358945*^9, 3.7674662871494894`*^9}, {
   3.7691489819888563`*^9, 3.769148989877303*^9}, {3.769149041909853*^9, 
   3.769149045332878*^9}, {3.769151511281187*^9, 3.7691515128522797`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Optimize Gate - now, the starting values are quite close to the final values, \
but they needn\[CloseCurlyQuote]t be\
\>", "Section",
 CellChangeTimes->{{3.753386837400745*^9, 3.753386839447563*^9}, {
  3.7696310272445602`*^9, 3.7696310461386538`*^9}}],

Cell[BoxData[{
 RowBox[{"clearVariables", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setVariables", "[", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T1", " ", "=", " ", 
   RowBox[{"5", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "9"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2", " ", "=", " ", 
   RowBox[{"110", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "9"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tmax", " ", "=", " ", 
    RowBox[{
     RowBox[{"2", "*", "T1"}], " ", "+", " ", "T2"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]EMid", " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", " ", "=", " ", "2000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]0Mid", " ", "=", " ", 
    RowBox[{"\[Epsilon]0", " ", "/.", " ", 
     RowBox[{"\[CapitalDelta]E", "\[Rule]", "\[CapitalDelta]EMid"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EaD", " ", "=", "255.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]ED", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "*", "\[Pi]", "*", 
      RowBox[{"(", 
       RowBox[{"\[Epsilon]0", " ", "-", " ", 
        RowBox[{"A", "/", "4"}], " ", "+", " ", 
        RowBox[{"A", "*", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dState", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "2"], "/", "2"}]}]}], ")"}]}], 
     " ", "-", " ", 
     RowBox[{"1", "*", "2", "*", "\[Pi]", "*", "2.0548", "*", 
      SuperscriptBox["10", "8"]}]}], " ", "/.", " ", 
    RowBox[{"\[CapitalDelta]E", "\[Rule]", "\[CapitalDelta]EMid"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]ED", " ", "=", " ", "3.37094*^10"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"BaD", " ", "=", 
     RowBox[{"EaD", "*", 
      FractionBox[
       RowBox[{"d", "*", "e"}], 
       RowBox[{"\[Gamma]e", "*", "h"}]]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BaD", " ", "=", " ", "0.03326"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]BD", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "*", "\[Pi]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"B0", "*", "\[Gamma]e"}], " ", "-", " ", 
        RowBox[{"A", "*", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"dState", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "2"], "/", "2"}]}]}], ")"}]}], 
     " ", "-", " ", 
     RowBox[{"1", "*", "2", "*", "\[Pi]", "*", "1.9759", "*", 
      SuperscriptBox["10", "8"]}]}], " ", "/.", " ", 
    RowBox[{"\[CapitalDelta]E", "\[Rule]", "\[CapitalDelta]EMid"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]BD", " ", "=", " ", "3.36003*^10"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]E", " ", "=", " ", 
    RowBox[{"10000", " ", "-", " ", 
     RowBox[{"12000", "*", 
      RowBox[{"twoPointWindow", "[", 
       RowBox[{"t", ",", " ", "T1", ",", " ", "Tmax", ",", " ", 
        RowBox[{"8", "/", "12"}]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"fidelityToGate", "[", 
    RowBox[{
    "EaD", ",", " ", "BaD", ",", " ", "\[Omega]ED", ",", " ", "\[Omega]BD", 
     ",", " ", "\"\<XY\>\""}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"Eamp", ",", " ", "Bamp"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eamp", "[", "t_", "]"}], " ", ":=", " ", 
   RowBox[{"EaD", "*", 
    SuperscriptBox[
     RowBox[{"cosWindow", "[", 
      RowBox[{
       RowBox[{"t", " ", "-", " ", "T1"}], ",", " ", 
       RowBox[{"T2", "/", "5"}], ",", " ", "T2"}], "]"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bamp", "[", "t_", "]"}], " ", ":=", " ", 
   RowBox[{"BaD", "*", 
    SuperscriptBox[
     RowBox[{"cosWindow", "[", 
      RowBox[{
       RowBox[{"t", " ", "-", " ", "T1"}], ",", " ", 
       RowBox[{"T2", "/", "5"}], ",", " ", "T2"}], "]"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]E", " ", "=", " ", "\[Omega]ED"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]B", " ", "=", " ", "\[Omega]BD"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", " ", "=", " ", 
    RowBox[{"findEvolutionOperator2D", "[", 
     RowBox[{"Hexact", ",", " ", "Tmax"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"U", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[CapitalLambda]ge", " ", "/.", " ", 
        RowBox[{"t", "\[Rule]", "t"}]}], ")"}], ".", 
      RowBox[{"findEvolutionOperator", "[", 
       RowBox[{"HexactID", ",", " ", "Tmax"}], "]"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"\[CapitalLambda]ge", " ", "/.", " ", 
        RowBox[{"t", "\[Rule]", "0"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Uuncut", " ", "=", " ", "U"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<XY fidelity (i.e. fidelity to X up to corrective Z-rotations) of the \
starting parameters:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fidelityXY", "[", 
   RowBox[{
    RowBox[{"U", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "2"}], "}"}]}], "]"}], "]"}], " ", "/.", " ", 
    RowBox[{"t", "\[Rule]", "Tmax"}]}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<----------------------------------------\>\"", " ", "<>", " ", 
    "\"\<startin'\>\"", " ", "<>", " ", 
    "\"\<----------------------------------------\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeConstrained", "[", 
   RowBox[{
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bestSoFar", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"bestParameters", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]", " ", "=", " ", ".1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]", " ", "=", " ", ".05"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<BOUNDS: Ea \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EaD", "*", 
              RowBox[{"(", 
               RowBox[{"1", " ", "-", " ", "\[Gamma]"}], ")"}]}], ",", " ", 
             RowBox[{"EaD", "*", 
              RowBox[{"(", 
               RowBox[{"1", " ", "+", " ", "\[Gamma]"}], ")"}]}]}], "}"}], 
           ",", " ", "TraditionalForm"}], "]"}], " ", "<>", " ", 
         "\"\< --- Ba \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"BaD", "*", 
              RowBox[{"(", 
               RowBox[{"1", " ", "-", " ", "\[Gamma]"}], ")"}]}], ",", " ", 
             RowBox[{"BaD", "*", 
              RowBox[{"(", 
               RowBox[{"1", " ", "+", " ", "\[Gamma]"}], ")"}]}]}], "}"}], 
           ",", " ", "TraditionalForm"}], "]"}], " ", "<>", " ", 
         "\"\< --- \[Omega]E: \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Omega]ED", " ", "-", " ", 
              RowBox[{"\[Delta]", "*", 
               SuperscriptBox["10", "8"]}]}], ",", " ", 
             RowBox[{"\[Omega]ED", " ", "+", " ", 
              RowBox[{"\[Delta]", "*", 
               SuperscriptBox["10", "8"]}]}]}], "}"}], ",", " ", 
           "TraditionalForm"}], "]"}], " ", "<>", " ", 
         "\"\< --- \[Omega]B: \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Omega]BD", " ", "-", " ", 
              RowBox[{"\[Delta]", "*", 
               SuperscriptBox["10", "8"]}]}], ",", " ", 
             RowBox[{"\[Omega]BD", " ", "+", " ", 
              RowBox[{"\[Delta]", "*", 
               SuperscriptBox["10", "8"]}]}]}], "}"}], ",", " ", 
           "TraditionalForm"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"NMaximize", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fidelityToGate", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"map", "[", 
              RowBox[{"x1", ",", " ", 
               RowBox[{"EaD", "*", 
                RowBox[{"(", 
                 RowBox[{"1", " ", "-", " ", "\[Gamma]"}], ")"}]}], ",", " ", 
               RowBox[{"EaD", "*", 
                RowBox[{"(", 
                 RowBox[{"1", " ", "+", " ", "\[Gamma]"}], ")"}]}]}], "]"}], 
             ",", "\[IndentingNewLine]", " ", 
             RowBox[{"map", "[", 
              RowBox[{"x1", ",", " ", 
               RowBox[{"BaD", "*", 
                RowBox[{"(", 
                 RowBox[{"1", " ", "-", " ", "\[Gamma]"}], ")"}]}], ",", " ", 
               RowBox[{"BaD", "*", 
                RowBox[{"(", 
                 RowBox[{"1", " ", "+", " ", "\[Gamma]"}], ")"}]}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"map", "[", 
              RowBox[{"x3", ",", " ", 
               RowBox[{"\[Omega]ED", " ", "-", " ", 
                RowBox[{"\[Delta]", "*", 
                 SuperscriptBox["10", "8"]}]}], ",", " ", 
               RowBox[{"\[Omega]ED", " ", "+", " ", 
                RowBox[{"\[Delta]", "*", 
                 SuperscriptBox["10", "8"]}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"map", "[", 
              RowBox[{"x4", ",", " ", 
               RowBox[{"\[Omega]BD", " ", "-", " ", 
                RowBox[{"\[Delta]", "*", 
                 SuperscriptBox["10", "8"]}]}], ",", " ", 
               RowBox[{"\[Omega]BD", " ", "+", " ", 
                RowBox[{"\[Delta]", "*", 
                 SuperscriptBox["10", "8"]}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\"\<XY\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"0", " ", "<", " ", "x1", " ", "<", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"0", " ", "<", " ", "x2", " ", "<", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"0", " ", "<", " ", "x3", " ", "<", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"0", " ", "<", " ", "x4", " ", "<", " ", "1"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", ".3", ",", " ", ".7"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"x2", ",", " ", ".3", ",", " ", ".7"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"x3", ",", " ", ".3", ",", " ", ".7"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"x4", ",", ".3", ",", " ", ".7"}], "}"}]}], 
          RowBox[{"(*", 
           RowBox[{",", " ", 
            RowBox[{"{", 
             RowBox[{"x5", ",", ".3", ",", " ", ".7"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"x6", ",", ".3", ",", " ", ".7"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"x7", ",", ".3", ",", " ", ".7"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"x8", ",", ".3", ",", " ", ".7"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"x9", ",", ".3", ",", " ", ".7"}], "}"}]}], "*)"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<NelderMead\>\"", ",", " ", 
            RowBox[{"\"\<RandomSeed\>\"", "\[Rule]", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "10000"}], "}"}], "]"}]}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", ")"}], ",", " ", 
    RowBox[{"60", "*", "60", "*", "10"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"clearVariables", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.753386897024288*^9, 3.7533870419085565`*^9}, {
   3.7533915533103476`*^9, 3.7533915629157953`*^9}, 3.753391618669091*^9, {
   3.753392688659405*^9, 3.7533926998099394`*^9}, {3.753461914209146*^9, 
   3.7534619359895935`*^9}, {3.753462128754692*^9, 3.7534621678212285`*^9}, {
   3.753462385033568*^9, 3.753462396723009*^9}, {3.7534896732764244`*^9, 
   3.753489675826951*^9}, {3.7534898173141804`*^9, 3.753489835318776*^9}, {
   3.753489885917534*^9, 3.753489892789561*^9}, {3.7534899405359755`*^9, 
   3.7534899414884186`*^9}, {3.7534907962460375`*^9, 3.753490818064429*^9}, {
   3.753492846587597*^9, 3.753492851019035*^9}, {3.753492905970277*^9, 
   3.753492906249115*^9}, {3.7534985201870575`*^9, 3.7534985227995396`*^9}, {
   3.753498582168885*^9, 3.7534985883393173`*^9}, {3.7535462723504095`*^9, 
   3.7535463019423084`*^9}, {3.753546716535446*^9, 3.7535467514562645`*^9}, {
   3.7541356989608006`*^9, 3.7541357159480014`*^9}, 3.7541358585197573`*^9, {
   3.754136582649293*^9, 3.754136582919132*^9}, {3.754136656541665*^9, 
   3.7541366879655356`*^9}, 3.754144137692554*^9, {3.754144173627823*^9, 
   3.754144204273144*^9}, {3.754144236157751*^9, 3.754144434244484*^9}, {
   3.7541448849323406`*^9, 3.754144907297438*^9}, {3.7541449444450097`*^9, 
   3.754144971023693*^9}, {3.7541450050250635`*^9, 3.7541450312019615`*^9}, {
   3.7541450624329476`*^9, 3.754145098477153*^9}, {3.754145157443139*^9, 
   3.7541451651197143`*^9}, {3.754145304462328*^9, 3.754145335291544*^9}, {
   3.7541453678767433`*^9, 3.7541454181047783`*^9}, {3.7541454689414463`*^9, 
   3.7541456094903665`*^9}, {3.7541456543894663`*^9, 
   3.7541456586919813`*^9}, {3.754145712495944*^9, 3.7541457147316546`*^9}, {
   3.7541457521550717`*^9, 3.754145754886495*^9}, {3.754145827153805*^9, 
   3.7541458451384277`*^9}, {3.754146337840205*^9, 3.754146342713395*^9}, {
   3.7541508806158333`*^9, 3.7541509962210436`*^9}, {3.7541519518295584`*^9, 
   3.754151983358163*^9}, {3.757958084389501*^9, 3.7579580891587586`*^9}, {
   3.757958869670892*^9, 3.7579588728390684`*^9}, {3.757960277329913*^9, 
   3.7579602783213415`*^9}, {3.7579603667754726`*^9, 
   3.7579603671112785`*^9}, {3.757960538718587*^9, 3.757960544516254*^9}, {
   3.7579608976881456`*^9, 3.7579609051478567`*^9}, {3.7661700335976396`*^9, 
   3.7661700343252087`*^9}, {3.767253901186458*^9, 3.7672539030283957`*^9}, {
   3.76725397163984*^9, 3.7672539717537746`*^9}, {3.767254031025607*^9, 
   3.7672540988265142`*^9}, {3.767254755497156*^9, 3.767254761608636*^9}, {
   3.7672554220109024`*^9, 3.76725542668321*^9}, {3.7672557227964964`*^9, 
   3.767255726893135*^9}, {3.7672557754341516`*^9, 3.767255892352744*^9}, {
   3.7672606605762873`*^9, 3.7672606972911205`*^9}, {3.7672607734552116`*^9, 
   3.767260774587576*^9}, {3.7672612020496936`*^9, 3.767261216469371*^9}, {
   3.7672926162746215`*^9, 3.7672926366868563`*^9}, {3.7672927052313366`*^9, 
   3.767292707981753*^9}, 3.767292827961582*^9, 3.767292955781893*^9, {
   3.767293035834777*^9, 3.767293045460228*^9}, {3.7672931335524406`*^9, 
   3.767293134519885*^9}, {3.7672931740560894`*^9, 3.767293317923564*^9}, {
   3.7672934733189754`*^9, 3.7672934753398094`*^9}, {3.7672935605239873`*^9, 
   3.76729356567302*^9}, {3.767295498914482*^9, 3.767295499148346*^9}, {
   3.7673720855930614`*^9, 3.7673720862207017`*^9}, {3.76737218078718*^9, 
   3.7673721831038437`*^9}, {3.767372255295224*^9, 3.7673722562666645`*^9}, {
   3.7673723022591505`*^9, 3.767372303093669*^9}, 3.767372479664016*^9, {
   3.767372712119793*^9, 3.767372717695582*^9}, {3.7673757478649836`*^9, 
   3.7673757484206657`*^9}, {3.767378684196725*^9, 3.767378723197239*^9}, {
   3.7673787651100764`*^9, 3.767378774288785*^9}, 3.767378812519743*^9, {
   3.7673805691370335`*^9, 3.767380576890562*^9}, {3.7673832290875363`*^9, 
   3.7673832595999455`*^9}, {3.767459635230839*^9, 3.767459641455249*^9}, {
   3.767462632718808*^9, 3.767462632899704*^9}, 3.767466301819034*^9, {
   3.7674683119825644`*^9, 3.7674683985503016`*^9}, {3.7691490633075237`*^9, 
   3.769149066242824*^9}, {3.7691491124252024`*^9, 3.769149115149635*^9}, {
   3.769149157725083*^9, 3.769149160626412*^9}, {3.7691511313022366`*^9, 
   3.7691511781062555`*^9}, 3.7691512708467903`*^9, 3.769151308956831*^9, {
   3.769151345104989*^9, 3.769151358974992*^9}, {3.769151415438442*^9, 
   3.769151417029522*^9}, {3.7691515677796154`*^9, 3.769151578109664*^9}, {
   3.7691858356013327`*^9, 3.7691858887666807`*^9}, {3.769185969819953*^9, 
   3.769185980105031*^9}, {3.7696310753577895`*^9, 3.7696311366004367`*^9}}]
}, Open  ]]
},
WindowSize->{1362, 674},
WindowMargins->{{Automatic, -5}, {Automatic, 2}},
Magnification:>1.1 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 104, 1, 78, "Section"],
Cell[687, 25, 13528, 248, 913, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14252, 278, 262, 5, 78, "Section"],
Cell[14517, 285, 17616, 388, 1518, "Input"]
}, Open  ]]
}
]
*)

